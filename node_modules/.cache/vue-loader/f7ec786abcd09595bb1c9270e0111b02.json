{"remainingRequest":"/web/vue/19-项目开发/supermall/node_modules/vue-loader/lib/index.js??vue-loader-options!/web/vue/19-项目开发/supermall/src/views/home/Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"/web/vue/19-项目开发/supermall/src/views/home/Home.vue","mtime":1595559589809},{"path":"/web/vue/19-项目开发/supermall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/web/vue/19-项目开发/supermall/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/web/vue/19-项目开发/supermall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/web/vue/19-项目开发/supermall/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIEhvbWXpobXnu4Tku7YKaW1wb3J0IEhvbWVTd2lwZXIgZnJvbSAiLi9jaGlsZENvbXBzL0hvbWVTd2lwZXIiOwppbXBvcnQgUmVjb21tZW5kVmlldyBmcm9tICIuL2NoaWxkQ29tcHMvUmVjb21tZW5kVmlldyI7CmltcG9ydCBGZWF0dXJlVmlldyBmcm9tICIuL2NoaWxkQ29tcHMvRmVhdHVyZVZpZXciOwovLyDlhazlhbHnmoTkuJrliqHnu4Tku7YKaW1wb3J0IE5hdkJhciBmcm9tICJjb21wb25lbnRzL2NvbW1vbi9uYXZiYXIvTmF2QmFyIjsKaW1wb3J0IFRhYkNvbnRyb2wgZnJvbSAiY29tcG9uZW50cy9jb250ZW50L3RhYkNvbnRyb2wvVGFiQ29udHJvbCI7CmltcG9ydCBHb29kc0xpc3QgZnJvbSAiY29tcG9uZW50cy9jb250ZW50L2dvb2RzL0dvb2RzTGlzdCI7CmltcG9ydCBTY3JvbGwgZnJvbSAiY29tcG9uZW50cy9jb21tb24vc2Nyb2xsL1Njcm9sbCI7CmltcG9ydCBCYWNrVG9wIGZyb20gImNvbXBvbmVudHMvY29udGVudC9iYWNrVG9wL0JhY2tUb3AiOwoKaW1wb3J0IHsgZ2V0SG9tZU11bHRpZGF0YSwgZ2V0SG9tZUdvb2RzIH0gZnJvbSAibmV0d29yay9ob21lIjsKaW1wb3J0IHsgZGVib3VuY2UgfSBmcm9tICJjb21tb24vdXRpbHMiOwoKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiSG9tZSIsCiAgY29tcG9uZW50czogewogICAgSG9tZVN3aXBlciwKICAgIFJlY29tbWVuZFZpZXcsCiAgICBGZWF0dXJlVmlldywKICAgIE5hdkJhciwKICAgIFRhYkNvbnRyb2wsCiAgICBHb29kc0xpc3QsCiAgICBTY3JvbGwsCiAgICBCYWNrVG9wCiAgfSwKICBkYXRhKCkgewogICAgLy/lm6DkuLrlh73mlbDooqvosIPnlKjkuYvlkI7vvIzph4zpnaLmiYDmnInnmoTkuJzopb/pg73kvJrooqvlhoXlrZjlm57mlLbmtojlpLHvvIzmiYDku6XpnIDopoHlnKhkYXRh5Lit5a2Y5pS+6K+35rGC5p2l55qE5pWw5o2uLAogICAgcmV0dXJuIHsKICAgICAgLy9yZXN1bHTov5nkuKrlj5jph4/lsZ7kuo7ov5nkuKrnu4Tku7bvvIzkuI3kvJrooqvlhoXlrZjlm57mlLYKICAgICAgLy8gcmVzdWx0Om51bGwKICAgICAgYmFubmVyczogW10sCiAgICAgIHJlY29tbWVuZHM6IFtdLAogICAgICBnb29kczogewogICAgICAgICdwb3AnOiB7cGFnZTowLCBsaXN0OltdfSwKICAgICAgICAnbmV3Jzoge3BhZ2U6MCwgbGlzdDpbXX0sCiAgICAgICAgJ3NlbGwnOiB7cGFnZTowLCBsaXN0OltdfQogICAgICB9LAogICAgICBjdXJyZW50VHlwZTogJ3BvcCcsCiAgICAgIGlzU2hvd0JhY2tUb3A6IGZhbHNlLAogICAgICB0YWJPZmZzZXRUb3A6IDAsCiAgICAgIGlzVGFiQ29udHJvbEZpeGVkOiBmYWxzZSwKICAgICAgc2F2ZVk6IDAKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBzaG93R29vZHMoKSB7CiAgICAgIHJldHVybiB0aGlzLmdvb2RzW3RoaXMuY3VycmVudFR5cGVdLmxpc3QKICAgIH0KICB9LAogIGRlc3Ryb3llZCgpIHsKICAgIGNvbnNvbGUubG9nKCdIb21lX2Rlc3Ryb3llZCcpOwogIH0sCiAgLy/ov5vlhaVIb21l6aG15pe277yM5rua5Yqo5Yiw5LmL5YmN5L+d5a2Y55qEc2F2ZVnnmoTkvY3nva7vvIzlubbov5vooYzkuIDmrKHliLfmlrAKICBhY3RpdmF0ZWQoKSB7CiAgICB0aGlzLiRyZWZzLnNjcm9sbC5zY3JvbGxUbygwLHRoaXMuc2F2ZVksMCkKICAgIHRoaXMuJHJlZnMuc2Nyb2xsLnJlZnJlc2goKQogIH0sCiAgZGVhY3RpdmF0ZWQoKSB7CiAgICAvLzHjgIHnprvlvIBIb21l6aG15pe277yM5oqK5rua5Yqo55qEeeWAvOi1i+WAvOe7mXNhdmVZCiAgICB0aGlzLnNhdmVZID0gdGhpcy4kcmVmcy5zY3JvbGwuZ2V0U2Nyb2xsWSgpCiAgfSwKICBjcmVhdGVkKCkgewogICAgLy/lnKhjcmVhdGVk6YeM6Z2i5Y+q5YaZ5Li76KaB6YC76L6RLOWPqui0n+i0o+iwg+eUqOaJp+ihjO+8jOWFt+S9k+eahOaWueazleWcqG1ldGhvZHPph4zpnaLlhpkKICAgIC8vMeOAgeWcqOmmlumhtee7hOS7tuWIm+W7uuWujOaIkOWQjuiwg+eUqOWkmuS4quaVsOaNruivt+axgueahOaWueazlQogICAgdGhpcy5nZXRIb21lTXVsdGlkYXRhKCkKICAgIC8vMuOAgeWcqOmmlumhtee7hOS7tuWIm+W7uuWujOaIkOWQjuiwg+eUqOWVhuWTgeaVsOaNruivt+axgueahOaWueazlQogICAgdGhpcy5nZXRIb21lR29vZHMoJ3BvcCcpCiAgICB0aGlzLmdldEhvbWVHb29kcygnbmV3JykKICAgIHRoaXMuZ2V0SG9tZUdvb2RzKCdzZWxsJykKICB9LAogIG1vdW50ZWQoKSB7CiAgICAvL+WbvueJh+WKoOi9veWujOaIkOeahOS6i+S7tuebkeWQrAogICAgY29uc3QgcmVmcmVzaCA9IGRlYm91bmNlKHRoaXMuJHJlZnMuc2Nyb2xsLnJlZnJlc2gsMjAwKQogICAgLy/nm5HlkKxHb29kc0xpc3RJdGVt5Lit5Zu+54mH5Yqg6L295a6M5oiQCiAgICB0aGlzLiRidXMuJG9uKCdob21lSXRlbUltYWdlTG9hZCcsKCkgPT4gewogICAgICAvLyB0aGlzLiRyZWZzLnNjcm9sbC5yZWZyZXNoKCkKICAgICAgcmVmcmVzaCgpCiAgICB9KQogIH0sCiAgbWV0aG9kczogewogICAgLyoqCiAgICAgKuS6i+S7tuivt+axguebuOWFs+eahOaWueazlQogICAgICogKiovCiAgICAvL+WIh+aNouagh+etvgogICAgdGFiQ2xpY2soaW5kZXgpIHsKICAgICAgc3dpdGNoKGluZGV4KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgdGhpcy5jdXJyZW50VHlwZSA9ICdwb3AnCiAgICAgICAgICBicmVhawogICAgICAgIGNhc2UgMToKICAgICAgICAgIHRoaXMuY3VycmVudFR5cGUgPSAnbmV3JwogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICB0aGlzLmN1cnJlbnRUeXBlID0gJ3NlbGwnCiAgICAgICAgICBicmVhawogICAgICB9CiAgICAgIHRoaXMuJHJlZnMudGFiQ29udHJvbDEuY3VycmVudEluZGV4ID0gaW5kZXg7CiAgICAgIHRoaXMuJHJlZnMudGFiQ29udHJvbDIuY3VycmVudEluZGV4ID0gaW5kZXg7CiAgICB9LAogICAgLy/lm57liLDpobbpg6gKICAgIGJhY2tDbGljaygpIHsKICAgICAgLy8gdGhpcy4kcmVmcy5zY3JvbGwuc2Nyb2xsLnNjcm9sbFRvKDAsMCwyMDApCiAgICAgIHRoaXMuJHJlZnMuc2Nyb2xsLnNjcm9sbFRvKDAsMCkKICAgIH0sCiAgICAvL+ebkeWQrOa7muWKqOeahOS9jee9rizmjqfliLZCYWNrVG9w57uE5Lu255qE5pi+56S65ZKM6ZqQ6JePCiAgICBjb250ZW50U2Nyb2xsKHBvc2l0aW9uKXsKICAgICAgLy8x44CB5Yik5patQmFja1RvcOaYr+WQpuaYvuekugogICAgICB0aGlzLmlzU2hvd0JhY2tUb3AgPSAoLXBvc2l0aW9uLnkpID4gODAwCiAgICAgIC8vMuOAgeWGs+WumnRhYkNvbnRyb2zmmK/lkKbmmL7npLoKICAgICAgdGhpcy5pc1RhYkNvbnRyb2xGaXhlZCA9ICgtcG9zaXRpb24ueSkgPiB0aGlzLnRhYk9mZnNldFRvcAogICAgfSwKICAgIC8v5LiK5ouJ5Yqg6L295pu05aSaCiAgICBsb2FkTW9yZSgpIHsKICAgICAgLy8gY29uc29sZS5sb2coJ+WKoOi9veabtOWkmueahOaWueazlScpOwogICAgICB0aGlzLmdldEhvbWVHb29kcyh0aGlzLmN1cnJlbnRUeXBlKQogICAgfSwKICAgIC8v55uR5ZCs6L2u5pKt5Zu+5piv5ZCm5Yqg6L295a6M5oiQCiAgICBzd2lwZXJJbWFnZUxvYWQoKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuJHJlZnMudGFiQ29udHJvbC4kZWwub2Zmc2V0VG9wKTsKICAgICAgdGhpcy50YWJPZmZzZXRUb3AgPSB0aGlzLiRyZWZzLnRhYkNvbnRyb2wyLiRlbC5vZmZzZXRUb3A7CiAgICB9LAogICAgLyoqCiAgICAgKue9kee7nOivt+axguebuOWFs+eahOaWueazlQogICAgICogKiovCiAgICAvLzHjgIHlvZNIb21l6aG16KKr5Yib5bu65Ye65p2l5pe277yM6K+35rGC5aSa5Liq5pWw5o2uCiAgICBnZXRIb21lTXVsdGlkYXRhKCkgewogICAgICBnZXRIb21lTXVsdGlkYXRhKCkudGhlbihyZXMgPT4gewogICAgICAgIC8v5Zug5Li65Y+Y6YePcmVzdWx05oyH5ZCRcmVzLOaJgOS7pXJlc+iiq+S/neWtmOS4i+adpQogICAgICAgIHRoaXMuYmFubmVycyA9IHJlcy5kYXRhLmJhbm5lci5saXN0OwogICAgICAgIHRoaXMucmVjb21tZW5kcyA9IHJlcy5kYXRhLnJlY29tbWVuZC5saXN0OwogICAgICB9KQogICAgfSwKICAgIC8vMuOAgeivt+axglRhYkNvbnRyb2znmoTllYblk4HmlbDmja4KICAgIGdldEhvbWVHb29kcyh0eXBlKSB7CiAgICAgIC8vcGFnZeS4jeiDveWGmeatu++8jOimgeagueaNrnR5cGXnsbvlnovlj5blh7rlvZPliY3nmoRwYWdlCiAgICAgIGNvbnN0IHBhZ2UgPSB0aGlzLmdvb2RzW3R5cGVdLnBhZ2UgKyAxCiAgICAgIGdldEhvbWVHb29kcyh0eXBlLHBhZ2UpLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLmdvb2RzW3R5cGVdLmxpc3QucHVzaCguLi5yZXMuZGF0YS5saXN0KQogICAgICAgIHRoaXMuZ29vZHNbdHlwZV0ucGFnZSArPSAxCiAgICAgICAgLy/lrozmiJDkuIrmi4nliqDovb3mm7TlpJrvvIzlv4XpobvosIPnlKjmraTmlrnms5XmiY3og73or7fmsYLlpJrmrKHmlbDmja4s5ZCm5YiZ5Y+q5pyJ5LiA5qyhCiAgICAgICAgdGhpcy4kcmVmcy5zY3JvbGwuZmluaXNoUHVsbFVwKCkKICAgICAgfSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views/home","sourcesContent":["<template>\n    <div id=\"home\">\n      <!--Home页的导航栏-->\n      <nav-bar class=\"home-nav\"><div slot=\"center\">购物街</div></nav-bar>\n      <!--Home页的流行、新款、精选-->\n      <tab-control :titles=\"['流行','新款','精选']\"\n                   @tabClick=\"tabClick\"\n                   ref=\"tabControl1\"\n                   class=\"tab-control\"\n                   v-show=\"isTabControlFixed\"/>\n      <scroll class=\"content\"\n              ref=\"scroll\"\n              :probe-type=\"3\"\n              @scroll=\"contentScroll\"\n              :pull-up-load=\"true\"\n              @pullingUp=\"loadMore\">\n        <!--Home页的轮播图-->\n        <home-swiper :banners=\"banners\" @swiperImageLoad=\"swiperImageLoad\"/>\n        <!--Home页的推荐信息-->\n        <recommend-view :recommends=\"recommends\"/>\n        <!--Home页的本周流行-->\n        <feature-view/>\n        <!--Home页的流行、新款、精选-->\n        <tab-control :titles=\"['流行','新款','精选']\"\n                     @tabClick=\"tabClick\"\n                     ref=\"tabControl2\"/>\n        <!--Home页的tab-control商品数据展示-->\n        <goods-list :goods=\"showGoods\" />\n      </scroll>\n\n      <back-top @click.native=\"backClick\" v-show=\"isShowBackTop\"></back-top>\n    </div>\n</template>\n\n<script>\n  // Home页组件\n  import HomeSwiper from \"./childComps/HomeSwiper\";\n  import RecommendView from \"./childComps/RecommendView\";\n  import FeatureView from \"./childComps/FeatureView\";\n  // 公共的业务组件\n  import NavBar from \"components/common/navbar/NavBar\";\n  import TabControl from \"components/content/tabControl/TabControl\";\n  import GoodsList from \"components/content/goods/GoodsList\";\n  import Scroll from \"components/common/scroll/Scroll\";\n  import BackTop from \"components/content/backTop/BackTop\";\n\n  import { getHomeMultidata, getHomeGoods } from \"network/home\";\n  import { debounce } from \"common/utils\";\n\n\n  export default {\n    name: \"Home\",\n    components: {\n      HomeSwiper,\n      RecommendView,\n      FeatureView,\n      NavBar,\n      TabControl,\n      GoodsList,\n      Scroll,\n      BackTop\n    },\n    data() {\n      //因为函数被调用之后，里面所有的东西都会被内存回收消失，所以需要在data中存放请求来的数据,\n      return {\n        //result这个变量属于这个组件，不会被内存回收\n        // result:null\n        banners: [],\n        recommends: [],\n        goods: {\n          'pop': {page:0, list:[]},\n          'new': {page:0, list:[]},\n          'sell': {page:0, list:[]}\n        },\n        currentType: 'pop',\n        isShowBackTop: false,\n        tabOffsetTop: 0,\n        isTabControlFixed: false,\n        saveY: 0\n      }\n    },\n    computed: {\n      showGoods() {\n        return this.goods[this.currentType].list\n      }\n    },\n    destroyed() {\n      console.log('Home_destroyed');\n    },\n    //进入Home页时，滚动到之前保存的saveY的位置，并进行一次刷新\n    activated() {\n      this.$refs.scroll.scrollTo(0,this.saveY,0)\n      this.$refs.scroll.refresh()\n    },\n    deactivated() {\n      //1、离开Home页时，把滚动的y值赋值给saveY\n      this.saveY = this.$refs.scroll.getScrollY()\n    },\n    created() {\n      //在created里面只写主要逻辑,只负责调用执行，具体的方法在methods里面写\n      //1、在首页组件创建完成后调用多个数据请求的方法\n      this.getHomeMultidata()\n      //2、在首页组件创建完成后调用商品数据请求的方法\n      this.getHomeGoods('pop')\n      this.getHomeGoods('new')\n      this.getHomeGoods('sell')\n    },\n    mounted() {\n      //图片加载完成的事件监听\n      const refresh = debounce(this.$refs.scroll.refresh,200)\n      //监听GoodsListItem中图片加载完成\n      this.$bus.$on('homeItemImageLoad',() => {\n        // this.$refs.scroll.refresh()\n        refresh()\n      })\n    },\n    methods: {\n      /**\n       *事件请求相关的方法\n       * **/\n      //切换标签\n      tabClick(index) {\n        switch(index) {\n          case 0:\n            this.currentType = 'pop'\n            break\n          case 1:\n            this.currentType = 'new'\n            break\n          case 2:\n            this.currentType = 'sell'\n            break\n        }\n        this.$refs.tabControl1.currentIndex = index;\n        this.$refs.tabControl2.currentIndex = index;\n      },\n      //回到顶部\n      backClick() {\n        // this.$refs.scroll.scroll.scrollTo(0,0,200)\n        this.$refs.scroll.scrollTo(0,0)\n      },\n      //监听滚动的位置,控制BackTop组件的显示和隐藏\n      contentScroll(position){\n        //1、判断BackTop是否显示\n        this.isShowBackTop = (-position.y) > 800\n        //2、决定tabControl是否显示\n        this.isTabControlFixed = (-position.y) > this.tabOffsetTop\n      },\n      //上拉加载更多\n      loadMore() {\n        // console.log('加载更多的方法');\n        this.getHomeGoods(this.currentType)\n      },\n      //监听轮播图是否加载完成\n      swiperImageLoad() {\n        // console.log(this.$refs.tabControl.$el.offsetTop);\n        this.tabOffsetTop = this.$refs.tabControl2.$el.offsetTop;\n      },\n      /**\n       *网络请求相关的方法\n       * **/\n      //1、当Home页被创建出来时，请求多个数据\n      getHomeMultidata() {\n        getHomeMultidata().then(res => {\n          //因为变量result指向res,所以res被保存下来\n          this.banners = res.data.banner.list;\n          this.recommends = res.data.recommend.list;\n        })\n      },\n      //2、请求TabControl的商品数据\n      getHomeGoods(type) {\n        //page不能写死，要根据type类型取出当前的page\n        const page = this.goods[type].page + 1\n        getHomeGoods(type,page).then(res => {\n          this.goods[type].list.push(...res.data.list)\n          this.goods[type].page += 1\n          //完成上拉加载更多，必须调用此方法才能请求多次数据,否则只有一次\n          this.$refs.scroll.finishPullUp()\n        })\n      }\n    }\n  }\n</script>\n\n<style scoped>\n  #home {\n    height: 100vh;\n    position: relative;\n    /*padding-top: 44px;*/\n    /*padding-bottom: 49px;*/\n  }\n  .home-nav {\n    background-color: var(--color-tint);\n    color: #ffffff;\n    /*以下属性是在使用浏览器原生滚动时,为了使导航不跟随滚动*/\n    /*position: fixed;*/\n    /*left: 0;*/\n    /*right: 0;*/\n    /*top: 0;*/\n    /*z-index: 1000;*/\n  }\n  /*.tab-control {*/\n  /*  !*滚动时当top值未达到规定值时，position：sticky；当达到规定值时，position:fixed；此属性在PC端有兼容问题，移动端可用*!*/\n  /*  position: sticky;*/\n  /*  top: 44px;*/\n  /*  z-index: 6;*/\n  /*}*/\n  .content {\n    overflow: hidden;\n    position: absolute;\n    top: 44px;\n    bottom: 49px;\n    left: 0;\n    right: 0;\n  }\n  .tab-control {\n    position: relative;\n    z-index: 9;\n  }\n  /*.content {*/\n  /*  height: calc(100%-93px);*/\n  /*  overflow: hidden;*/\n  /*  margin-top: 44px;*/\n  /*}*/\n\n</style>\n"]}]}