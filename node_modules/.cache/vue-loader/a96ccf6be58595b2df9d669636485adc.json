{"remainingRequest":"/web/vue/19-项目开发/supermall/node_modules/vue-loader/lib/index.js??vue-loader-options!/web/vue/19-项目开发/supermall/src/views/home/Home.vue?vue&type=style&index=0&id=3dd2e005&scoped=true&lang=css&","dependencies":[{"path":"/web/vue/19-项目开发/supermall/src/views/home/Home.vue","mtime":1595559589809},{"path":"/web/vue/19-项目开发/supermall/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/web/vue/19-项目开发/supermall/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/web/vue/19-项目开发/supermall/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/web/vue/19-项目开发/supermall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/web/vue/19-项目开发/supermall/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgojaG9tZSB7CiAgaGVpZ2h0OiAxMDB2aDsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgLypwYWRkaW5nLXRvcDogNDRweDsqLwogIC8qcGFkZGluZy1ib3R0b206IDQ5cHg7Ki8KfQouaG9tZS1uYXYgewogIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWNvbG9yLXRpbnQpOwogIGNvbG9yOiAjZmZmZmZmOwogIC8q5Lul5LiL5bGe5oCn5piv5Zyo5L2/55So5rWP6KeI5Zmo5Y6f55Sf5rua5Yqo5pe2LOS4uuS6huS9v+WvvOiIquS4jei3n+maj+a7muWKqCovCiAgLypwb3NpdGlvbjogZml4ZWQ7Ki8KICAvKmxlZnQ6IDA7Ki8KICAvKnJpZ2h0OiAwOyovCiAgLyp0b3A6IDA7Ki8KICAvKnotaW5kZXg6IDEwMDA7Ki8KfQovKi50YWItY29udHJvbCB7Ki8KLyogICEq5rua5Yqo5pe25b2TdG9w5YC85pyq6L6+5Yiw6KeE5a6a5YC85pe277yMcG9zaXRpb27vvJpzdGlja3nvvJvlvZPovr7liLDop4TlrprlgLzml7bvvIxwb3NpdGlvbjpmaXhlZO+8m+atpOWxnuaAp+WcqFBD56uv5pyJ5YW85a656Zeu6aKY77yM56e75Yqo56uv5Y+v55SoKiEqLwovKiAgcG9zaXRpb246IHN0aWNreTsqLwovKiAgdG9wOiA0NHB4OyovCi8qICB6LWluZGV4OiA2OyovCi8qfSovCi5jb250ZW50IHsKICBvdmVyZmxvdzogaGlkZGVuOwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDQ0cHg7CiAgYm90dG9tOiA0OXB4OwogIGxlZnQ6IDA7CiAgcmlnaHQ6IDA7Cn0KLnRhYi1jb250cm9sIHsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgei1pbmRleDogOTsKfQovKi5jb250ZW50IHsqLwovKiAgaGVpZ2h0OiBjYWxjKDEwMCUtOTNweCk7Ki8KLyogIG92ZXJmbG93OiBoaWRkZW47Ki8KLyogIG1hcmdpbi10b3A6IDQ0cHg7Ki8KLyp9Ki8KCg=="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views/home","sourcesContent":["<template>\n    <div id=\"home\">\n      <!--Home页的导航栏-->\n      <nav-bar class=\"home-nav\"><div slot=\"center\">购物街</div></nav-bar>\n      <!--Home页的流行、新款、精选-->\n      <tab-control :titles=\"['流行','新款','精选']\"\n                   @tabClick=\"tabClick\"\n                   ref=\"tabControl1\"\n                   class=\"tab-control\"\n                   v-show=\"isTabControlFixed\"/>\n      <scroll class=\"content\"\n              ref=\"scroll\"\n              :probe-type=\"3\"\n              @scroll=\"contentScroll\"\n              :pull-up-load=\"true\"\n              @pullingUp=\"loadMore\">\n        <!--Home页的轮播图-->\n        <home-swiper :banners=\"banners\" @swiperImageLoad=\"swiperImageLoad\"/>\n        <!--Home页的推荐信息-->\n        <recommend-view :recommends=\"recommends\"/>\n        <!--Home页的本周流行-->\n        <feature-view/>\n        <!--Home页的流行、新款、精选-->\n        <tab-control :titles=\"['流行','新款','精选']\"\n                     @tabClick=\"tabClick\"\n                     ref=\"tabControl2\"/>\n        <!--Home页的tab-control商品数据展示-->\n        <goods-list :goods=\"showGoods\" />\n      </scroll>\n\n      <back-top @click.native=\"backClick\" v-show=\"isShowBackTop\"></back-top>\n    </div>\n</template>\n\n<script>\n  // Home页组件\n  import HomeSwiper from \"./childComps/HomeSwiper\";\n  import RecommendView from \"./childComps/RecommendView\";\n  import FeatureView from \"./childComps/FeatureView\";\n  // 公共的业务组件\n  import NavBar from \"components/common/navbar/NavBar\";\n  import TabControl from \"components/content/tabControl/TabControl\";\n  import GoodsList from \"components/content/goods/GoodsList\";\n  import Scroll from \"components/common/scroll/Scroll\";\n  import BackTop from \"components/content/backTop/BackTop\";\n\n  import { getHomeMultidata, getHomeGoods } from \"network/home\";\n  import { debounce } from \"common/utils\";\n\n\n  export default {\n    name: \"Home\",\n    components: {\n      HomeSwiper,\n      RecommendView,\n      FeatureView,\n      NavBar,\n      TabControl,\n      GoodsList,\n      Scroll,\n      BackTop\n    },\n    data() {\n      //因为函数被调用之后，里面所有的东西都会被内存回收消失，所以需要在data中存放请求来的数据,\n      return {\n        //result这个变量属于这个组件，不会被内存回收\n        // result:null\n        banners: [],\n        recommends: [],\n        goods: {\n          'pop': {page:0, list:[]},\n          'new': {page:0, list:[]},\n          'sell': {page:0, list:[]}\n        },\n        currentType: 'pop',\n        isShowBackTop: false,\n        tabOffsetTop: 0,\n        isTabControlFixed: false,\n        saveY: 0\n      }\n    },\n    computed: {\n      showGoods() {\n        return this.goods[this.currentType].list\n      }\n    },\n    destroyed() {\n      console.log('Home_destroyed');\n    },\n    //进入Home页时，滚动到之前保存的saveY的位置，并进行一次刷新\n    activated() {\n      this.$refs.scroll.scrollTo(0,this.saveY,0)\n      this.$refs.scroll.refresh()\n    },\n    deactivated() {\n      //1、离开Home页时，把滚动的y值赋值给saveY\n      this.saveY = this.$refs.scroll.getScrollY()\n    },\n    created() {\n      //在created里面只写主要逻辑,只负责调用执行，具体的方法在methods里面写\n      //1、在首页组件创建完成后调用多个数据请求的方法\n      this.getHomeMultidata()\n      //2、在首页组件创建完成后调用商品数据请求的方法\n      this.getHomeGoods('pop')\n      this.getHomeGoods('new')\n      this.getHomeGoods('sell')\n    },\n    mounted() {\n      //图片加载完成的事件监听\n      const refresh = debounce(this.$refs.scroll.refresh,200)\n      //监听GoodsListItem中图片加载完成\n      this.$bus.$on('homeItemImageLoad',() => {\n        // this.$refs.scroll.refresh()\n        refresh()\n      })\n    },\n    methods: {\n      /**\n       *事件请求相关的方法\n       * **/\n      //切换标签\n      tabClick(index) {\n        switch(index) {\n          case 0:\n            this.currentType = 'pop'\n            break\n          case 1:\n            this.currentType = 'new'\n            break\n          case 2:\n            this.currentType = 'sell'\n            break\n        }\n        this.$refs.tabControl1.currentIndex = index;\n        this.$refs.tabControl2.currentIndex = index;\n      },\n      //回到顶部\n      backClick() {\n        // this.$refs.scroll.scroll.scrollTo(0,0,200)\n        this.$refs.scroll.scrollTo(0,0)\n      },\n      //监听滚动的位置,控制BackTop组件的显示和隐藏\n      contentScroll(position){\n        //1、判断BackTop是否显示\n        this.isShowBackTop = (-position.y) > 800\n        //2、决定tabControl是否显示\n        this.isTabControlFixed = (-position.y) > this.tabOffsetTop\n      },\n      //上拉加载更多\n      loadMore() {\n        // console.log('加载更多的方法');\n        this.getHomeGoods(this.currentType)\n      },\n      //监听轮播图是否加载完成\n      swiperImageLoad() {\n        // console.log(this.$refs.tabControl.$el.offsetTop);\n        this.tabOffsetTop = this.$refs.tabControl2.$el.offsetTop;\n      },\n      /**\n       *网络请求相关的方法\n       * **/\n      //1、当Home页被创建出来时，请求多个数据\n      getHomeMultidata() {\n        getHomeMultidata().then(res => {\n          //因为变量result指向res,所以res被保存下来\n          this.banners = res.data.banner.list;\n          this.recommends = res.data.recommend.list;\n        })\n      },\n      //2、请求TabControl的商品数据\n      getHomeGoods(type) {\n        //page不能写死，要根据type类型取出当前的page\n        const page = this.goods[type].page + 1\n        getHomeGoods(type,page).then(res => {\n          this.goods[type].list.push(...res.data.list)\n          this.goods[type].page += 1\n          //完成上拉加载更多，必须调用此方法才能请求多次数据,否则只有一次\n          this.$refs.scroll.finishPullUp()\n        })\n      }\n    }\n  }\n</script>\n\n<style scoped>\n  #home {\n    height: 100vh;\n    position: relative;\n    /*padding-top: 44px;*/\n    /*padding-bottom: 49px;*/\n  }\n  .home-nav {\n    background-color: var(--color-tint);\n    color: #ffffff;\n    /*以下属性是在使用浏览器原生滚动时,为了使导航不跟随滚动*/\n    /*position: fixed;*/\n    /*left: 0;*/\n    /*right: 0;*/\n    /*top: 0;*/\n    /*z-index: 1000;*/\n  }\n  /*.tab-control {*/\n  /*  !*滚动时当top值未达到规定值时，position：sticky；当达到规定值时，position:fixed；此属性在PC端有兼容问题，移动端可用*!*/\n  /*  position: sticky;*/\n  /*  top: 44px;*/\n  /*  z-index: 6;*/\n  /*}*/\n  .content {\n    overflow: hidden;\n    position: absolute;\n    top: 44px;\n    bottom: 49px;\n    left: 0;\n    right: 0;\n  }\n  .tab-control {\n    position: relative;\n    z-index: 9;\n  }\n  /*.content {*/\n  /*  height: calc(100%-93px);*/\n  /*  overflow: hidden;*/\n  /*  margin-top: 44px;*/\n  /*}*/\n\n</style>\n"]}]}